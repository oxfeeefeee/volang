# Channel test: buffered channel send/recv

module channel

func main
  locals 10
  # r0 = new channel (type 18=CHAN, buffer size 2)
  0: ChanNew r0, 18, 2
  # r1 = 42
  1: LoadInt r1, 42
  # send 42 to channel
  2: ChanSend r0, r1
  # r2 = recv from channel
  3: ChanRecv r2, r0, r3
  # print r2 (should be 42)
  4: DebugPrint r2
  # r4 = 100
  5: LoadInt r4, 100
  # send 100 to channel
  6: ChanSend r0, r4
  # r5 = recv from channel
  7: ChanRecv r5, r0, r6
  # print r5 (should be 100)
  8: DebugPrint r5
  9: Return r0, 0
end

entry main
