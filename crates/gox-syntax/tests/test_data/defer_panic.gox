// Defer, panic, and recover test
package main;

// Defer with function call
func deferExample() {
    defer println("cleanup");
    defer close(file);
    println("working");
}

// Defer with anonymous function
func deferAnonymous() {
    defer func() {
        println("deferred anonymous");
    }();
    println("before defer runs");
}

// Multiple defers (LIFO order)
func multipleDefers() {
    defer println("third");
    defer println("second");
    defer println("first");
}

// Panic usage
func panicExample() {
    panic("something went wrong");
}

// Recover usage
func recoverExample() {
    r := recover();
    if r != nil {
        println("recovered from panic");
    }
}

// Combined defer and recover pattern
func safeCall() {
    defer func() {
        r := recover();
        if r != nil {
            println("caught panic");
        }
    }();
    panicExample();
}

func main() {
    deferExample();
    safeCall();
}
